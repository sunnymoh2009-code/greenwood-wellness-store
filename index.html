<script>
  // ----- Affiliate tags -----
  const AFFILIATE_TAG_US = "greenwoodinvestments-20";
  const AFFILIATE_TAG_CA = "greenwoodin01-20";

  // ----- Product catalog (CA ASIN known for Lingo Leap only) -----
  const products = [
    { title: "Lingo Leap", subtitle: "Speech & Communication Support Drops", asinUS: "B0D2F9CZR5", asinCA: "B0F47D7K8H", bullets: ["Zeolite + D3 + B12", "Supports language development", "Kid-friendly drops"], badge: "Flagship" },
    { title: "Genius Drops (1 oz)", subtitle: "Clinically-Proven Focus Support", asinUS: "B075FH1P4Y", asinCA: null, bullets: ["Ginkgo biloba blend", "Focus & attention", "30 servings"] },
    { title: "Genius Drops (4 oz)", subtitle: "Family Size Focus Support", asinUS: "B07J6RFL35", asinCA: null, bullets: ["Herbal nootropics", "120 servings", "Liquid formula"] },
    { title: "Vitamin D3 Gummies for Kids", subtitle: "D3 + K2 – Growth & Development", asinUS: "B0C87JFLDN", asinCA: null, bullets: ["60 gummies", "Kids & teens", "Bone & immunity"] },
    { title: "Immune Drops", subtitle: "Elderberry + Echinacea + Oregon Grape Root", asinUS: "B078WK3Q4K", asinCA: null, bullets: ["Sugar-free", "Herbal immunity", "Family-friendly"] },
    { title: "Zeolite Drops for Kids", subtitle: "Natural Zeolite + Vitamin D3", asinUS: "B0D2BKRDD7", asinCA: null, bullets: ["Daily wellness", "Zero-chemical zeolite", "Berry flavor"] },
    { title: "Kids B-Complex", subtitle: "B Vitamins + Elderberry + Zinc + C", asinUS: "B0B18RX61R", asinCA: null, bullets: ["Overall wellness", "30 servings", "Amazon's Choice"] },
    { title: "School Backup Support Bundle", subtitle: "Immune wellness kit for kids & teens", asinUS: "B0D9PHYCWF", asinCA: null, bullets: ["Non-GMO", "USA-made", "Bundle savings"] }
  ];

  // ----- Region detection -----
  const isCA =
    (navigator.language || "").toLowerCase().includes("en-ca") ||
    (Intl.DateTimeFormat().resolvedOptions().timeZone || "").includes("America/Edmonton") ||
    location.hostname.endsWith(".ca");

  // ----- Build Amazon URL (direct CA when known; CA search fallback; else US) -----
  function buyUrl(p) {
    if (isCA) {
      if (p.asinCA) return `https://www.amazon.ca/dp/${p.asinCA}?tag=${encodeURIComponent(AFFILIATE_TAG_CA)}`;
      const q = encodeURIComponent(p.title);
      return `https://www.amazon.ca/s?k=${q}&tag=${encodeURIComponent(AFFILIATE_TAG_CA)}`;
    }
    return `https://www.amazon.com/dp/${p.asinUS}?tag=${encodeURIComponent(AFFILIATE_TAG_US)}`;
  }

  // ----- Render product cards -----
  function productCard(p) {
    const li = document.createElement("div");
    li.className = "group relative flex flex-col justify-between rounded-2xl border bg-white p-4 shadow-sm transition hover:shadow-md";
    li.innerHTML = `
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="text-base font-semibold leading-tight">${p.title}</h3>
          <p class="text-sm text-gray-600">${p.subtitle}</p>
        </div>
        <div class="shrink-0 rounded-xl bg-gray-100 p-3">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3h18v4H3zM11 7h2v14h-2z"/>
          </svg>
        </div>
      </div>
      <ul class="mt-3 space-y-1 text-sm text-gray-700">
        ${p.bullets.map(b => `<li class="flex items-start gap-2"><span class="dot"></span><span>${b}</span></li>`).join("")}
      </ul>
      <div class="mt-4 flex items-center justify-between">
        ${p.badge ? `<span class="inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-xs font-medium">⭐ ${p.badge}</span>` : `<span></span>`}
        <a href="${buyUrl(p)}" target="_blank" rel="nofollow sponsored noopener"
           class="inline-flex items-center gap-2 rounded-xl border bg-black px-3 py-2 text-sm font-semibold text-white transition hover:-translate-y-px hover:opacity-95">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 6h15l-1.5 9h-12z"/><circle cx="9" cy="20" r="1.5"/><circle cx="18" cy="20" r="1.5"/>
          </svg>
          Buy on Amazon
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M7 7h10v10"/><path d="M7 17 17 7"/>
          </svg>
        </a>
      </div>
    `;
    return li;
  }

  // ----- Render all products & set top CTA -----
  const grid = document.getElementById("grid");
  products.forEach(p => grid.appendChild(productCard(p)));
  document.getElementById("shopLingo").href = buyUrl(products[0]);
</script>
